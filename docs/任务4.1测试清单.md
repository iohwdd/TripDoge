# 任务4.1：对话页面布局 - 测试清单

## 测试环境
- 开发服务器：`npm run dev`
- 后端API：`http://localhost:8080`
- 测试路由：`/user/chat/:roleId`

## 功能测试清单

### 1. 页面加载测试
- [ ] 访问 `/user/chat/1`（使用有效的角色ID）
- [ ] 页面显示加载状态（Spin组件）
- [ ] 成功加载角色信息后，显示对话页面
- [ ] 访问无效的角色ID时，显示错误提示并跳转回首页
- [ ] 未登录时，路由守卫正确拦截

### 2. 顶部栏测试
- [ ] 显示返回按钮，点击后返回首页
- [ ] 显示角色头像（如果有）
- [ ] 显示角色名称
- [ ] 显示角色描述（如果有）
- [ ] 显示重置按钮
- [ ] 重置按钮点击后显示加载状态

### 3. 消息列表测试
- [ ] 无消息时显示空状态提示
- [ ] 有历史消息时正确显示
- [ ] 用户消息显示在右侧（蓝色背景）
- [ ] AI消息显示在左侧（白色背景）
- [ ] 消息显示用户头像和AI头像
- [ ] 消息显示时间戳
- [ ] 新消息自动滚动到底部
- [ ] 消息有淡入动画效果

### 4. 输入框测试
- [ ] 输入框可以正常输入文本
- [ ] 支持多行输入（自动调整高度）
- [ ] 回车键发送消息（不换行）
- [ ] Shift+Enter 换行
- [ ] 发送按钮在输入为空时禁用
- [ ] 发送消息时显示加载状态
- [ ] 发送后清空输入框

### 5. 发送消息测试（占位实现）
- [ ] 点击发送按钮发送消息
- [ ] 用户消息立即显示在消息列表
- [ ] 显示AI回复占位消息（"流式对话功能将在任务4.2中实现..."）
- [ ] 发送过程中显示打字指示器

### 6. 重置对话测试
- [ ] 点击重置按钮
- [ ] 显示确认或成功提示
- [ ] 清空当前消息列表
- [ ] 重置后可以继续发送新消息

### 7. 上传图片按钮测试
- [ ] 显示上传图片按钮
- [ ] 点击后显示提示信息（功能待实现）

### 8. 初始消息测试
- [ ] 从首页带 `initialMessage` 参数跳转时，输入框预填充消息
- [ ] 可以修改预填充的消息
- [ ] 可以发送预填充的消息

### 9. 响应式测试
- [ ] 桌面端布局正常
- [ ] 移动端布局正常（< 768px）
- [ ] 消息列表在小屏幕上正确显示
- [ ] 输入框在小屏幕上正确显示

### 10. 错误处理测试
- [ ] API调用失败时显示错误提示
- [ ] 网络错误时显示友好提示
- [ ] 角色不存在时显示错误并跳转

## 测试步骤

### 基础流程测试
1. 登录系统
2. 访问首页 `/user`
3. 选择一个专家，点击发送按钮
4. 跳转到对话页面 `/user/chat/:roleId`
5. 验证页面正常加载
6. 输入消息并发送
7. 验证消息显示
8. 测试重置功能
9. 测试返回功能

### 边界情况测试
1. 测试无效的角色ID
2. 测试空消息发送（应该被阻止）
3. 测试长文本消息显示
4. 测试快速连续发送多条消息
5. 测试页面刷新后消息是否保留（应该从API重新加载）

## 预期结果

### 成功场景
- ✅ 页面正常加载，显示角色信息
- ✅ 消息列表正确显示历史消息
- ✅ 可以发送消息并看到回复
- ✅ 重置功能正常工作
- ✅ 所有按钮和交互正常

### 失败场景
- ✅ 错误情况有友好提示
- ✅ 无效操作被正确阻止
- ✅ 网络错误有适当处理

## 已知问题

1. **SSE流式对话未实现**：当前发送消息后显示占位回复，实际流式对话将在任务4.2中实现
2. **图片上传未实现**：上传图片按钮已添加，但功能将在任务4.2中实现

## 测试完成标准

- [ ] 所有功能测试项通过
- [ ] 响应式测试通过
- [ ] 错误处理测试通过
- [ ] 代码构建无错误
- [ ] 浏览器控制台无错误



