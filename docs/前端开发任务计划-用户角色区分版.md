# TripDoge 前端开发任务计划（用户角色区分版）

**创建日期**: 2025-01-27  
**项目状态**: 后端API已完成，前端待开发  
**后端API地址**: `http://localhost:8080` (开发环境) / `https://trip-doge-frontend.zeabur.app` (生产环境)

---

## 📋 用户角色说明

### 👤 使用用户（普通用户）
- **权限范围**: 使用平台提供的AI角色进行对话、管理个人文档、自定义角色等
- **主要功能**:
  - 与AI角色对话
  - 查看和管理角色列表
  - 上传和管理个人文档
  - 自定义创建角色（个人使用）
  - 管理个人对话历史

### 🔧 管理员
- **权限范围**: 系统配置管理、平台角色管理、用户管理等
- **主要功能**:
  - LLM供应商配置管理
  - 系统初始角色管理（增删改查）
  - 用户管理（查看、禁用/启用）
  - 系统配置管理
  - 数据统计和监控

---

## 📊 总体进度概览

| 模块 | 任务数 | 已完成 | 进行中 | 待开始 | 完成率 |
|------|-------|--------|--------|--------|--------|
| **项目初始化** | 5 | 0 | 0 | 5 | **0%** |
| **用户端-用户管理** | 6 | 0 | 0 | 6 | **0%** |
| **用户端-角色管理** | 5 | 0 | 0 | 5 | **0%** |
| **用户端-AI对话** | 4 | 0 | 0 | 4 | **0%** |
| **用户端-文档管理** | 5 | 0 | 0 | 5 | **0%** |
| **管理端-登录认证** | 2 | 0 | 0 | 2 | **0%** |
| **管理端-LLM配置** | 4 | 0 | 0 | 4 | **0%** |
| **管理端-角色管理** | 6 | 0 | 0 | 6 | **0%** |
| **管理端-用户管理** | 4 | 0 | 0 | 4 | **0%** |
| **管理端-系统配置** | 3 | 0 | 0 | 3 | **0%** |
| **公共组件** | 5 | 0 | 0 | 5 | **0%** |
| **测试** | 4 | 0 | 0 | 4 | **0%** |
| **总计** | **53** | **0** | **0** | **53** | **0%** |

---

## 🎯 技术栈建议

### 推荐方案
- **框架**: React 18+ / Vue 3+ / Next.js
- **UI库**: Ant Design / Element Plus / shadcn/ui
- **状态管理**: Zustand / Pinia / Redux Toolkit
- **HTTP客户端**: Axios
- **SSE处理**: EventSource API / fetch with stream
- **路由**: React Router / Vue Router
- **构建工具**: Vite / Next.js
- **TypeScript**: 推荐使用

### 后端API基础信息
- **Base URL**: `http://localhost:8080` (开发) / 生产环境待定
- **API前缀**: `/api` (部分接口) 或直接路径
- **认证方式**: Bearer Token (放在Header: `Authorization: Bearer {token}`)
- **响应格式**: 
  ```typescript
  {
    code: number,
    data: T,
    message: string
  }
  ```

---

## 📦 模块一：项目初始化 (0/5)

### ✅ 任务1.1: 项目脚手架搭建
- [ ] 创建前端项目（React/Vue/Next.js）
- [ ] 配置开发环境（Vite/Webpack）
- [ ] 配置TypeScript（如使用）
- [ ] 配置ESLint和Prettier
- [ ] 配置路径别名（@/src等）

**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务1.2: 基础依赖安装
- [ ] 安装UI组件库
- [ ] 安装HTTP客户端（Axios）
- [ ] 安装路由库
- [ ] 安装状态管理库
- [ ] 安装工具库（dayjs、lodash等）

**优先级**: P0  
**预计工时**: 1小时

### ✅ 任务1.3: 项目结构搭建
- [ ] 创建目录结构
  - `src/pages/user/` - 用户端页面
  - `src/pages/admin/` - 管理端页面
  - `src/components/user/` - 用户端组件
  - `src/components/admin/` - 管理端组件
  - `src/components/common/` - 公共组件
  - `src/api/user/` - 用户端API
  - `src/api/admin/` - 管理端API
  - `src/utils/` - 工具函数
  - `src/types/` - 类型定义
- [ ] 配置路由结构（用户端路由 + 管理端路由）
- [ ] 创建公共样式文件
- [ ] 配置环境变量（.env）

**优先级**: P0  
**预计工时**: 1.5小时

### ✅ 任务1.4: API请求封装
- [ ] 封装Axios实例（baseURL、拦截器）
- [ ] 实现请求拦截器（添加Token）
- [ ] 实现响应拦截器（统一错误处理）
- [ ] 封装常用请求方法（get、post等）
- [ ] 区分用户端和管理端API实例（如需要）

**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务1.5: 类型定义
- [ ] 定义API响应类型（Result<T>）
- [ ] 定义用户相关类型（UserInfoVO、UserLoginDTO等）
- [ ] 定义角色相关类型（RoleInfoVO、RoleDetailVO等）
- [ ] 定义文档相关类型（DocVO、DocUploadResultVO等）
- [ ] 定义管理员相关类型（AdminUserVO、LLMConfigVO等）
- [ ] 定义错误码类型
- [ ] 定义用户角色枚举（USER、ADMIN）

**优先级**: P0  
**预计工时**: 2.5小时

---

## 👤 模块二：用户端-用户管理模块 (0/6)

### ✅ 任务2.1: 用户注册页面
- [ ] 设计注册表单（邮箱、密码、验证码）
- [ ] 实现邮箱格式验证
- [ ] 实现密码强度验证
- [ ] 实现验证码输入
- [ ] 调用注册API (`POST /api/user/register`)
- [ ] 处理注册成功/失败逻辑
- [ ] 注册成功后跳转登录页

**API接口**: `POST /api/user/register`  
**请求体**: `UserRegisterDTO { email, password, code }`  
**响应**: `Result<UserInfoVO>`  
**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务2.2: 用户登录页面
- [ ] 设计登录表单（邮箱、密码）
- [ ] 实现表单验证
- [ ] 调用登录API (`POST /api/user/login`)
- [ ] 保存Token到本地存储（localStorage/sessionStorage）
- [ ] 保存用户信息到状态管理（包含用户角色）
- [ ] 根据用户角色跳转到对应首页（用户端/管理端）

**API接口**: `POST /api/user/login`  
**请求体**: `UserLoginDTO { email, password }`  
**响应**: `Result<{ userInfo, token, tokenType }>`  
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务2.3: 发送验证码功能
- [ ] 在注册页面添加"发送验证码"按钮
- [ ] 实现倒计时功能（60秒）
- [ ] 调用发送验证码API (`POST /api/user/sendEmail`)
- [ ] 处理发送成功/失败提示
- [ ] 开发模式下显示验证码（后端返回）

**API接口**: `POST /api/user/sendEmail`  
**请求体**: `EmailCodeDTO { email }`  
**响应**: `Result<EmailCodeVO>`  
**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务2.4: 用户登出功能
- [ ] 在用户菜单/导航栏添加登出按钮
- [ ] 调用登出API (`POST /api/user/logout`)
- [ ] 清除本地Token和用户信息
- [ ] 跳转到登录页

**API接口**: `POST /api/user/logout`  
**优先级**: P1  
**预计工时**: 1小时

### ✅ 任务2.5: 获取用户信息
- [ ] 创建获取用户信息的API调用
- [ ] 在应用启动时检查Token有效性
- [ ] 自动获取用户信息并更新状态
- [ ] 处理Token过期情况
- [ ] 根据用户角色显示对应导航菜单

**API接口**: `POST /api/user/info`  
**响应**: `Result<UserInfoVO>`  
**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务2.6: 路由守卫
- [ ] 实现登录状态检查
- [ ] 实现角色权限检查（用户端/管理端路由分离）
- [ ] 未登录用户访问受保护路由时跳转登录页
- [ ] 已登录用户访问登录/注册页时跳转首页
- [ ] 普通用户访问管理端路由时提示无权限
- [ ] Token过期时自动登出

**优先级**: P0  
**预计工时**: 3小时

---

## 🎭 模块三：用户端-角色管理模块 (0/5)

### ✅ 任务3.1: 角色列表页面
- [ ] 设计角色列表UI（卡片/列表布局）
- [ ] 调用角色列表API (`POST /api/roles/list`)
- [ ] 实现分页功能（后端已支持）
- [ ] 显示角色头像、名称、描述
- [ ] 点击角色卡片跳转到对话页
- [ ] 处理加载状态和错误状态
- [ ] 添加"创建自定义角色"入口

**API接口**: `POST /api/roles/list`  
**请求体**: `RoleListQueryDTO { page, pageSize }` (可选)  
**响应**: `Result<List<RoleInfoVO>>`  
**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务3.2: 角色详情页面
- [ ] 设计角色详情UI
- [ ] 调用角色详情API (`POST /api/roles/{roleId}/detail`)
- [ ] 显示角色详细信息（头像、名称、描述、系统提示词等）
- [ ] 显示"开始对话"按钮
- [ ] 显示角色特性（性格、专长等）

**API接口**: `POST /api/roles/{roleId}/detail`  
**响应**: `Result<RoleDetailVO>`  
**优先级**: P1  
**预计工时**: 3小时

### ✅ 任务3.3: 创建自定义角色（用户端）
- [ ] 设计创建角色表单
  - 角色名称、头像上传、描述
  - 系统提示词编辑
  - AI参数配置（temperature、max_tokens等）
  - 角色特性设置（性格、专长等）
- [ ] 实现表单验证
- [ ] 调用创建角色API (`POST /api/user/roles/create`)
- [ ] 处理创建成功/失败
- [ ] 创建成功后跳转到角色列表或对话页

**API接口**: `POST /api/user/roles/create` (需后端实现)  
**请求体**: `UserRoleCreateDTO { name, avatar, description, aiSetting, roleSetting }`  
**响应**: `Result<RoleInfoVO>`  
**优先级**: P1  
**预计工时**: 5小时

### ✅ 任务3.4: 编辑自定义角色（用户端）
- [ ] 设计编辑角色表单（复用创建表单）
- [ ] 调用获取角色详情API
- [ ] 调用更新角色API (`PUT /api/user/roles/{roleId}`)
- [ ] 处理更新成功/失败

**API接口**: `PUT /api/user/roles/{roleId}` (需后端实现)  
**优先级**: P1  
**预计工时**: 3小时

### ✅ 任务3.5: 删除自定义角色（用户端）
- [ ] 在角色列表中显示删除按钮（仅自定义角色）
- [ ] 实现删除确认对话框
- [ ] 调用删除角色API (`DELETE /api/user/roles/{roleId}`)
- [ ] 处理删除成功/失败
- [ ] 刷新角色列表

**API接口**: `DELETE /api/user/roles/{roleId}` (需后端实现)  
**优先级**: P1  
**预计工时**: 2小时

---

## 💬 模块四：用户端-AI对话模块 (0/4)

### ✅ 任务4.1: 对话页面布局
- [ ] 设计对话页面UI（消息列表 + 输入框）
- [ ] 实现消息列表滚动（自动滚动到底部）
- [ ] 实现输入框和发送按钮
- [ ] 显示角色信息和头像
- [ ] 添加"重置对话"按钮
- [ ] 添加"上传图片"按钮（多模态）

**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务4.2: SSE流式对话实现
- [ ] 实现SSE连接 (`POST /api/chat/{roleId}`)
- [ ] 处理流式数据接收（EventSource或fetch stream）
- [ ] 实时更新消息显示（打字机效果）
- [ ] 处理连接错误和重连逻辑
- [ ] 处理连接超时
- [ ] 支持图片消息显示

**API接口**: `POST /api/chat/{roleId}`  
**请求体**: `ChatReqDTO { content, fileId? }`  
**响应**: SSE流 (`text/event-stream`)  
**优先级**: P0  
**预计工时**: 6小时

### ✅ 任务4.3: 对话历史记录
- [ ] 调用获取历史记录API (`POST /api/chat/{roleId}/history`)
- [ ] 在对话页面加载时显示历史消息
- [ ] 实现历史消息分页加载（如需要）
- [ ] 区分用户消息和AI消息样式
- [ ] 支持图片消息显示

**API接口**: `POST /api/chat/{roleId}/history`  
**响应**: `Result<List<ChatHistoryDO>>`  
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务4.4: 重置对话功能
- [ ] 实现重置对话按钮点击事件
- [ ] 调用重置API (`POST /api/chat/{roleId}/reset`)
- [ ] 清空当前对话消息
- [ ] 显示重置成功提示

**API接口**: `POST /api/chat/{roleId}/reset`  
**优先级**: P1  
**预计工时**: 1小时

---

## 📄 模块五：用户端-文档管理模块 (0/5)

### ✅ 任务5.1: 文档上传功能
- [ ] 设计文档上传UI（拖拽上传/点击上传）
- [ ] 实现文件选择器
- [ ] 实现文件类型验证（前端预检查）
- [ ] 实现文件大小验证（前端预检查）
- [ ] 显示上传进度
- [ ] 调用文档上传API (`POST /api/doc/parse`)
- [ ] 处理上传成功/失败
- [ ] 支持选择关联角色（可选）

**API接口**: `POST /api/doc/parse`  
**请求体**: `UploadDTO { file: MultipartFile, roleId: Long }`  
**响应**: `Result<DocUploadResultVO>`  
**优先级**: P0  
**预计工时**: 5小时

### ✅ 任务5.2: 文档列表页面
- [ ] 设计文档列表UI（表格/卡片）
- [ ] 调用文档列表API (`POST /api/doc/list`)
- [ ] 显示文档信息（名称、上传时间、状态等）
- [ ] 实现按角色筛选
- [ ] 实现分页（如后端支持）
- [ ] 显示文档解析状态

**API接口**: `POST /api/doc/list`  
**请求体**: `DocListDTO { roleId?: Long }`  
**响应**: `Result<List<DocVO>>`  
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务5.3: 文档下载功能
- [ ] 在文档列表中添加下载按钮
- [ ] 调用文档下载API (`POST /api/doc/download`)
- [ ] 处理文件下载（Blob方式）
- [ ] 显示下载进度

**API接口**: `POST /api/doc/download`  
**请求体**: `DocDownloadDTO { docId: Long }`  
**响应**: 文件流  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务5.4: 文档删除功能
- [ ] 在文档列表中添加删除按钮
- [ ] 实现删除确认对话框
- [ ] 调用文档删除API (`POST /api/doc/delete`)
- [ ] 处理删除成功/失败（部分成功情况）
- [ ] 刷新文档列表

**API接口**: `POST /api/doc/delete`  
**请求体**: `DocDelDTO { docId: Long }`  
**响应**: `Result<DocDeleteResultDTO>`  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务5.5: 多模态文件上传（图片）
- [ ] 在对话输入框添加图片上传功能
- [ ] 实现图片预览
- [ ] 调用文件上传API获取fileId
- [ ] 在发送消息时携带fileId
- [ ] 在消息中显示图片

**API接口**: 文件上传接口（需确认）  
**优先级**: P1  
**预计工时**: 3小时

---

## 🔐 模块六：管理端-登录认证 (0/2)

### ✅ 任务6.1: 管理员登录页面
- [ ] 设计管理员登录页面（独立于用户登录）
- [ ] 实现登录表单（邮箱、密码）
- [ ] 调用登录API（复用用户登录接口，后端需验证管理员权限）
- [ ] 验证用户角色为管理员
- [ ] 登录成功后跳转管理端首页

**API接口**: `POST /api/user/login` (后端需验证管理员权限)  
**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务6.2: 管理端路由守卫
- [ ] 实现管理员权限检查
- [ ] 非管理员用户访问管理端路由时提示无权限
- [ ] 管理员访问用户端路由时正常访问（可选）
- [ ] Token过期时自动登出

**优先级**: P0  
**预计工时**: 2小时

---

## ⚙️ 模块七：管理端-LLM配置管理 (0/4)

### ✅ 任务7.1: LLM供应商列表页面
- [ ] 设计LLM供应商列表UI（表格）
- [ ] 调用获取LLM配置API (`GET /api/admin/llm/configs`)
- [ ] 显示供应商信息（名称、API Key状态、模型列表等）
- [ ] 显示当前使用的供应商
- [ ] 实现切换供应商功能

**API接口**: `GET /api/admin/llm/configs` (需后端实现)  
**响应**: `Result<List<LLMConfigVO>>`  
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务7.2: 添加LLM供应商
- [ ] 设计添加供应商表单
  - 供应商名称（DashScope、OpenAI等）
  - API Key输入
  - 模型配置（模型名称、temperature等）
  - 是否设为默认
- [ ] 实现表单验证
- [ ] 调用添加供应商API (`POST /api/admin/llm/configs`)
- [ ] 处理添加成功/失败

**API接口**: `POST /api/admin/llm/configs` (需后端实现)  
**请求体**: `LLMConfigCreateDTO { provider, apiKey, modelName, temperature, ... }`  
**响应**: `Result<LLMConfigVO>`  
**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务7.3: 编辑LLM供应商配置
- [ ] 设计编辑供应商表单（复用添加表单）
- [ ] 调用获取供应商详情API (`GET /api/admin/llm/configs/{id}`)
- [ ] 调用更新供应商API (`PUT /api/admin/llm/configs/{id}`)
- [ ] 处理更新成功/失败
- [ ] 支持测试连接功能

**API接口**: 
- `GET /api/admin/llm/configs/{id}` (需后端实现)
- `PUT /api/admin/llm/configs/{id}` (需后端实现)
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务7.4: 删除/禁用LLM供应商
- [ ] 在供应商列表中显示删除/禁用按钮
- [ ] 实现删除确认对话框
- [ ] 调用删除/禁用API (`DELETE /api/admin/llm/configs/{id}`)
- [ ] 处理删除成功/失败
- [ ] 如果删除的是当前使用的供应商，提示切换

**API接口**: `DELETE /api/admin/llm/configs/{id}` (需后端实现)  
**优先级**: P1  
**预计工时**: 2小时

---

## 🎭 模块八：管理端-角色管理 (0/6)

### ✅ 任务8.1: 系统角色列表页面
- [ ] 设计系统角色列表UI（表格）
- [ ] 调用获取系统角色API (`GET /api/admin/roles`)
- [ ] 显示角色信息（名称、状态、排序等）
- [ ] 实现分页功能
- [ ] 实现搜索和筛选功能

**API接口**: `GET /api/admin/roles` (需后端实现)  
**响应**: `Result<PageResult<RoleInfoVO>>`  
**优先级**: P0  
**预计工时**: 3小时

### ✅ 任务8.2: 创建系统角色
- [ ] 设计创建角色表单
  - 角色代码、名称、头像上传
  - 角色描述
  - AI配置（system_prompt、temperature、max_tokens等）
  - 角色特性配置（性格、专长等）
  - 状态、排序权重
- [ ] 实现表单验证
- [ ] 调用创建角色API (`POST /api/admin/roles`)
- [ ] 处理创建成功/失败

**API接口**: `POST /api/admin/roles` (需后端实现)  
**请求体**: `AdminRoleCreateDTO { code, name, avatar, description, aiSetting, roleSetting, status, sortOrder }`  
**响应**: `Result<RoleInfoVO>`  
**优先级**: P0  
**预计工时**: 5小时

### ✅ 任务8.3: 编辑系统角色
- [ ] 设计编辑角色表单（复用创建表单）
- [ ] 调用获取角色详情API (`GET /api/admin/roles/{id}`)
- [ ] 调用更新角色API (`PUT /api/admin/roles/{id}`)
- [ ] 处理更新成功/失败

**API接口**: 
- `GET /api/admin/roles/{id}` (需后端实现)
- `PUT /api/admin/roles/{id}` (需后端实现)
**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务8.4: 删除系统角色
- [ ] 在角色列表中显示删除按钮
- [ ] 实现删除确认对话框
- [ ] 调用删除角色API (`DELETE /api/admin/roles/{id}`)
- [ ] 处理删除成功/失败
- [ ] 如果角色正在被使用，提示警告

**API接口**: `DELETE /api/admin/roles/{id}` (需后端实现)  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务8.5: 启用/禁用角色
- [ ] 在角色列表中显示启用/禁用开关
- [ ] 调用更新角色状态API (`PUT /api/admin/roles/{id}/status`)
- [ ] 处理更新成功/失败
- [ ] 实时更新列表状态

**API接口**: `PUT /api/admin/roles/{id}/status` (需后端实现)  
**请求体**: `{ status: 0|1 }`  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务8.6: 角色排序功能
- [ ] 在角色列表中实现拖拽排序
- [ ] 调用更新排序API (`PUT /api/admin/roles/sort`)
- [ ] 处理更新成功/失败
- [ ] 实时更新列表顺序

**API接口**: `PUT /api/admin/roles/sort` (需后端实现)  
**请求体**: `{ roleIds: Long[] }`  
**优先级**: P2  
**预计工时**: 3小时

---

## 👥 模块九：管理端-用户管理 (0/4)

### ✅ 任务9.1: 用户列表页面
- [ ] 设计用户列表UI（表格）
- [ ] 调用获取用户列表API (`GET /api/admin/users`)
- [ ] 显示用户信息（邮箱、昵称、注册时间、状态等）
- [ ] 实现分页功能
- [ ] 实现搜索功能（按邮箱、昵称）

**API接口**: `GET /api/admin/users` (需后端实现)  
**响应**: `Result<PageResult<UserInfoVO>>`  
**优先级**: P1  
**预计工时**: 3小时

### ✅ 任务9.2: 用户详情查看
- [ ] 设计用户详情页面/弹窗
- [ ] 调用获取用户详情API (`GET /api/admin/users/{id}`)
- [ ] 显示用户详细信息
- [ ] 显示用户统计数据（对话数、文档数等）

**API接口**: `GET /api/admin/users/{id}` (需后端实现)  
**响应**: `Result<AdminUserDetailVO>`  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务9.3: 启用/禁用用户
- [ ] 在用户列表中显示启用/禁用开关
- [ ] 调用更新用户状态API (`PUT /api/admin/users/{id}/status`)
- [ ] 处理更新成功/失败
- [ ] 实时更新列表状态

**API接口**: `PUT /api/admin/users/{id}/status` (需后端实现)  
**请求体**: `{ status: 0|1 }`  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务9.4: 重置用户密码
- [ ] 在用户详情中添加"重置密码"按钮
- [ ] 实现重置密码确认对话框
- [ ] 调用重置密码API (`POST /api/admin/users/{id}/reset-password`)
- [ ] 处理重置成功/失败
- [ ] 显示临时密码（如后端返回）

**API接口**: `POST /api/admin/users/{id}/reset-password` (需后端实现)  
**响应**: `Result<{ tempPassword: string }>`  
**优先级**: P2  
**预计工时**: 2小时

---

## ⚙️ 模块十：管理端-系统配置 (0/3)

### ✅ 任务10.1: 系统配置页面
- [ ] 设计系统配置UI（表单）
- [ ] 调用获取系统配置API (`GET /api/admin/system/config`)
- [ ] 显示系统配置项
  - 文件上传限制（大小、类型）
  - 对话配置（最大token数、压缩配置等）
  - 邮件配置（SMTP设置）
  - MinIO配置（端点、密钥等）
- [ ] 实现配置编辑功能

**API接口**: `GET /api/admin/system/config` (需后端实现)  
**响应**: `Result<SystemConfigVO>`  
**优先级**: P1  
**预计工时**: 4小时

### ✅ 任务10.2: 更新系统配置
- [ ] 实现配置表单提交
- [ ] 调用更新系统配置API (`PUT /api/admin/system/config`)
- [ ] 处理更新成功/失败
- [ ] 显示配置更新提示

**API接口**: `PUT /api/admin/system/config` (需后端实现)  
**请求体**: `SystemConfigUpdateDTO { ... }`  
**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务10.3: 系统监控和统计
- [ ] 设计系统监控面板
- [ ] 调用获取统计数据API (`GET /api/admin/system/stats`)
- [ ] 显示统计数据
  - 用户总数、活跃用户数
  - 对话总数、今日对话数
  - 文档总数、存储使用量
  - 系统健康状态
- [ ] 实现数据刷新功能

**API接口**: `GET /api/admin/system/stats` (需后端实现)  
**响应**: `Result<SystemStatsVO>`  
**优先级**: P2  
**预计工时**: 4小时

---

## 🧩 模块十一：公共组件 (0/5)

### ✅ 任务11.1: 错误处理组件
- [ ] 创建统一错误提示组件（Toast/Message）
- [ ] 根据错误码显示不同错误信息
- [ ] 实现错误码映射表
- [ ] 处理网络错误、超时等异常情况
- [ ] 区分用户端和管理端的错误提示样式

**优先级**: P0  
**预计工时**: 2小时

### ✅ 任务11.2: 加载状态组件
- [ ] 创建Loading组件
- [ ] 实现全屏加载遮罩
- [ ] 实现局部加载状态
- [ ] 实现骨架屏（Skeleton）

**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务11.3: 用户信息展示组件
- [ ] 创建用户头像组件
- [ ] 创建用户信息下拉菜单
- [ ] 集成登出功能
- [ ] 显示用户邮箱/昵称
- [ ] 区分用户端和管理端的用户信息展示

**优先级**: P1  
**预计工时**: 2小时

### ✅ 任务11.4: 布局组件
- [ ] 创建用户端布局组件（Header + Content + Footer）
- [ ] 创建管理端布局组件（侧边栏 + Header + Content）
- [ ] 实现响应式布局
- [ ] 实现导航菜单

**优先级**: P0  
**预计工时**: 4小时

### ✅ 任务11.5: 响应式适配
- [ ] 实现移动端适配
- [ ] 实现平板端适配
- [ ] 实现桌面端布局优化
- [ ] 测试不同屏幕尺寸
- [ ] 管理端优先适配桌面端

**优先级**: P1  
**预计工时**: 4小时

---

## 🧪 模块十二：测试 (0/4)

### ✅ 任务12.1: 单元测试配置
- [ ] 配置测试框架（Jest/Vitest + React Testing Library/Vue Test Utils）
- [ ] 配置测试覆盖率工具
- [ ] 创建测试工具函数（mock API、render helpers等）
- [ ] 编写工具函数单元测试（API封装、工具函数等）

**优先级**: P1  
**预计工时**: 3小时

### ✅ 任务12.2: 组件单元测试
- [ ] 编写公共组件单元测试（错误处理、加载状态、用户信息等）
- [ ] 编写用户端核心组件测试（登录表单、角色列表、对话界面等）
- [ ] 编写管理端核心组件测试（LLM配置表单、角色管理表格等）
- [ ] 测试覆盖率目标：核心组件 > 70%

**优先级**: P1  
**预计工时**: 8小时

### ✅ 任务12.3: 集成测试
- [ ] 配置E2E测试框架（Playwright/Cypress）
- [ ] 编写用户端核心流程测试
  - 注册 → 登录 → 查看角色 → 开始对话
  - 上传文档 → 查看文档列表 → 删除文档
- [ ] 编写管理端核心流程测试
  - 管理员登录 → 配置LLM → 创建角色 → 管理用户
- [ ] 测试关键业务场景

**优先级**: P1  
**预计工时**: 6小时

### ✅ 任务12.4: 测试CI/CD集成
- [ ] 配置GitHub Actions/CircleCI等CI流程
- [ ] 单元测试自动运行
- [ ] E2E测试自动运行（可选，可手动触发）
- [ ] 测试覆盖率报告生成
- [ ] 测试失败时阻止合并

**优先级**: P2  
**预计工时**: 2小时

---

## 🔗 API接口汇总

### 用户端接口

#### 用户管理
- `POST /api/user/register` - 用户注册
- `POST /api/user/login` - 用户登录
- `POST /api/user/sendEmail` - 发送验证码
- `POST /api/user/logout` - 用户登出
- `POST /api/user/info` - 获取用户信息

#### 角色管理（用户端）
- `POST /api/roles/list` - 获取角色列表（需登录）
- `POST /api/roles/{roleId}/detail` - 获取角色详情
- `GET /api/roles/public/list` - 获取公开角色列表（无需登录）
- `POST /api/user/roles/create` - 创建自定义角色（需后端实现）
- `PUT /api/user/roles/{roleId}` - 更新自定义角色（需后端实现）
- `DELETE /api/user/roles/{roleId}` - 删除自定义角色（需后端实现）

#### AI对话
- `POST /api/chat/{roleId}` - SSE流式对话
- `POST /api/chat/{roleId}/reset` - 重置对话上下文
- `POST /api/chat/{roleId}/history` - 获取对话历史

#### 文档管理
- `POST /api/doc/parse` - 文档上传并解析
- `POST /api/doc/list` - 文档列表查询
- `POST /api/doc/download` - 文档下载
- `POST /api/doc/delete` - 文档删除

### 管理端接口（需后端实现）

#### LLM配置管理
- `GET /api/admin/llm/configs` - 获取LLM配置列表
- `POST /api/admin/llm/configs` - 添加LLM供应商
- `GET /api/admin/llm/configs/{id}` - 获取LLM配置详情
- `PUT /api/admin/llm/configs/{id}` - 更新LLM配置
- `DELETE /api/admin/llm/configs/{id}` - 删除LLM配置

#### 角色管理（管理端）
- `GET /api/admin/roles` - 获取系统角色列表
- `POST /api/admin/roles` - 创建系统角色
- `GET /api/admin/roles/{id}` - 获取角色详情
- `PUT /api/admin/roles/{id}` - 更新系统角色
- `DELETE /api/admin/roles/{id}` - 删除系统角色
- `PUT /api/admin/roles/{id}/status` - 启用/禁用角色
- `PUT /api/admin/roles/sort` - 更新角色排序

#### 用户管理
- `GET /api/admin/users` - 获取用户列表
- `GET /api/admin/users/{id}` - 获取用户详情
- `PUT /api/admin/users/{id}/status` - 启用/禁用用户
- `POST /api/admin/users/{id}/reset-password` - 重置用户密码

#### 系统配置
- `GET /api/admin/system/config` - 获取系统配置
- `PUT /api/admin/system/config` - 更新系统配置
- `GET /api/admin/system/stats` - 获取系统统计数据

---

## 📝 注意事项

1. **用户角色区分**
   - 前端需要根据用户角色（USER/ADMIN）显示不同的导航和功能
   - 用户端和管理端使用不同的路由前缀（/user/* 和 /admin/*）
   - 管理端功能需要管理员权限验证

2. **Token管理**
   - Token存储在localStorage或sessionStorage
   - 每次请求在Header中添加：`Authorization: Bearer {token}`
   - Token过期时自动跳转登录页

3. **错误处理**
   - 统一处理HTTP错误码
   - 根据后端返回的code字段显示对应错误信息
   - 网络错误时显示友好提示
   - 权限不足时显示明确提示

4. **SSE连接**
   - 注意处理连接断开和重连
   - 实现心跳检测
   - 页面切换时正确关闭连接

5. **文件上传**
   - 前端预检查文件类型和大小
   - 显示上传进度
   - 处理大文件上传

6. **响应式设计**
   - 用户端优先考虑移动端体验
   - 管理端优先适配桌面端
   - 对话页面需要适配不同屏幕

---

## 🎯 开发优先级

### P0（核心功能，必须完成）
1. 项目初始化（任务1.1-1.5）
2. 用户端-用户管理（任务2.1-2.3, 2.5-2.6）
3. 用户端-角色列表（任务3.1）
4. 用户端-SSE流式对话（任务4.1-4.3）
5. 用户端-文档上传（任务5.1）
6. 管理端-登录认证（任务6.1-6.2）
7. 管理端-LLM配置管理（任务7.1-7.3）
8. 管理端-角色管理（任务8.1-8.3）
9. 错误处理组件（任务11.1）
10. 布局组件（任务11.4）

### P1（重要功能）
1. 用户端-角色详情和自定义角色（任务3.2-3.5）
2. 用户端-文档管理（任务5.2-5.5）
3. 管理端-用户管理（任务9.1-9.3）
4. 管理端-系统配置（任务10.1-10.2）
5. 加载状态组件（任务11.2）
6. 用户信息组件（任务11.3）

### P2（优化功能）
1. 管理端-角色排序（任务8.6）
2. 管理端-重置密码（任务9.4）
3. 管理端-系统监控（任务10.3）
4. 响应式适配（任务11.5）
5. 测试CI/CD集成（任务12.4）

### 测试优先级说明
- **P1（重要）**: 单元测试配置、组件测试、集成测试 - 核心功能开发完成后进行
- **P2（优化）**: CI/CD集成 - 项目稳定后集成

---

**文档版本**: v2.0  
**最后更新**: 2025-01-27

